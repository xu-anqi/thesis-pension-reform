--------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/angelxu/Desktop/thesis/data/SOEP/reform analysis/log/3_did_assumption_test.log
  log type:  text
 opened on:  30 Apr 2025, 03:30:42

. 
. ***********************************************
. * Pre-trend Interaction Test
. ***********************************************
. use "${DATA}data_head.dta", clear

. 
. * Generate Post-Reform Indicator
. gen post = syear > 2006

. 
. * Generate Interaction Term for DiD
. gen interaction = post * type_employment

. 
. 
. *** if_savings ***
. logit if_savings post##type_employment, robust

Iteration 0:   log pseudolikelihood = -62770.773  
Iteration 1:   log pseudolikelihood = -62718.518  
Iteration 2:   log pseudolikelihood = -62718.318  
Iteration 3:   log pseudolikelihood = -62718.318  

Logistic regression                             Number of obs     =    101,601
                                                Wald chi2(3)      =     106.35
                                                Prob > chi2       =     0.0000
Log pseudolikelihood = -62718.318               Pseudo R2         =     0.0008

--------------------------------------------------------------------------------------
                     |               Robust
          if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
              1.post |   .7214028   .0894377     8.07   0.000     .5461081    .8966975
   1.type_employment |   .4774138   .0843006     5.66   0.000     .3121876    .6426399
                     |
post#type_employment |
                1 1  |   -.614422   .0910996    -6.74   0.000    -.7929739     -.43587
                     |
               _cons |   .2414532   .0828698     2.91   0.004     .0790315     .403875
--------------------------------------------------------------------------------------

. 
. logit if_savings type_employment##i.syear, robust

Iteration 0:   log pseudolikelihood = -62770.773  
Iteration 1:   log pseudolikelihood = -62273.381  
Iteration 2:   log pseudolikelihood = -62270.702  
Iteration 3:   log pseudolikelihood = -62270.701  

Logistic regression                             Number of obs     =    101,601
                                                Wald chi2(61)     =     969.70
                                                Prob > chi2       =     0.0000
Log pseudolikelihood = -62270.701               Pseudo R2         =     0.0080

---------------------------------------------------------------------------------------
                      |               Robust
           if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
    1.type_employment |   1.094845    .537655     2.04   0.042     .0410605    2.148629
                      |
                syear |
                1993  |   .4054642   .7817397     0.52   0.604    -1.126718    1.937646
                1994  |   1.504077     .97183     1.55   0.122    -.4006754    3.408828
                1995  |     .96508    .818927     1.18   0.239    -.6399874    2.570147
                1996  |   .1177824   .9279652     0.13   0.899    -1.700996    1.936561
                1997  |   .2231427   .8027769     0.28   0.781    -1.350271    1.796556
                1998  |   .4054642    .691218     0.59   0.557    -.9492982    1.760227
                1999  |   .6286078   .7090717     0.89   0.375    -.7611472    2.018363
                2000  |   .4284537   .5690026     0.75   0.451    -.6867709    1.543678
                2001  |   .7472135   .5840667     1.28   0.201    -.3975361    1.891963
                2002  |   .5389956   .5756321     0.94   0.349    -.5892227    1.667214
                2003  |     .96508   .5858816     1.65   0.100    -.1832268    2.113387
                2004  |   .5645289   .5845302     0.97   0.334    -.5811292    1.710187
                2005  |   .9253397     .59183     1.56   0.118    -.2346257    2.085305
                2006  |   .7326771   .5773169     1.27   0.204    -.3988433    1.864198
                2007  |   1.167604   .5895951     1.98   0.048     .0120191    2.323189
                2008  |   1.280933   .5904358     2.17   0.030        .1237    2.438166
                2009  |   1.006238   .5686138     1.77   0.077    -.1082245    2.120701
                2010  |    .852602    .543343     1.57   0.117    -.2123307    1.917535
                2011  |   1.032521   .5437092     1.90   0.058    -.0331291    2.098172
                2012  |   .9464196   .5444214     1.74   0.082    -.1206267    2.013466
                2013  |   .8708275   .5411597     1.61   0.108     -.189826    1.931481
                2014  |   1.156599   .5474927     2.11   0.035     .0835327    2.229665
                2015  |   .8662794   .5455896     1.59   0.112    -.2030566    1.935615
                2016  |   1.107661   .5522423     2.01   0.045     .0252863    2.190036
                2017  |   1.176389   .5470733     2.15   0.032     .1041451    2.248633
                2018  |   1.486058   .5492708     2.71   0.007      .409507    2.562609
                2019  |   1.844483   .5344721     3.45   0.001     .7969365    2.892029
                2020  |   1.779896    .538146     3.31   0.001     .7251488    2.834642
                2021  |   1.896269   .5463941     3.47   0.001     .8253558    2.967181
                2022  |   1.530816   .5371677     2.85   0.004     .4779867    2.583645
                      |
type_employment#syear |
              1 1993  |  -.2565157   .7952088    -0.32   0.747    -1.815096    1.302065
              1 1994  |  -1.312673   .9818196    -1.34   0.181    -3.237004     .611658
              1 1995  |  -.9781916   .8296058    -1.18   0.238    -2.604189    .6478059
              1 1996  |  -.0550597   .9372134    -0.06   0.953    -1.891964    1.781845
              1 1997  |  -.1419298   .8131554    -0.17   0.861    -1.735685    1.451825
              1 1998  |  -.4138559   .7025846    -0.59   0.556    -1.790896    .9631846
              1 1999  |  -.5777234   .7199957    -0.80   0.422    -1.988889    .8334423
              1 2000  |  -.3979745   .5810097    -0.68   0.493    -1.536733    .7407836
              1 2001  |  -.6295884   .5959106    -1.06   0.291    -1.797552     .538375
              1 2002  |   -.534392   .5875004    -0.91   0.363    -1.685872    .6170877
              1 2003  |  -.9862645   .5974568    -1.65   0.099    -2.157258    .1847292
              1 2004  |  -.5679309   .5961164    -0.95   0.341    -1.736298    .6004357
              1 2005  |  -.8783105   .6032684    -1.46   0.145    -2.060695    .3040739
              1 2006  |  -.7698744   .5887755    -1.31   0.191    -1.923853    .3841044
              1 2007  |  -1.049225   .6009015    -1.75   0.081     -2.22697    .1285204
              1 2008  |   -1.14498   .6017608    -1.90   0.057    -2.324409    .0344493
              1 2009  |  -.9371056   .5801371    -1.62   0.106    -2.074153    .1999422
              1 2010  |  -1.036465   .5545711    -1.87   0.062    -2.123404    .0504745
              1 2011  |  -1.111855   .5548536    -2.00   0.045    -2.199348   -.0243623
              1 2012  |  -1.060547   .5555259    -1.91   0.056    -2.149357    .0282639
              1 2013  |  -.9815388   .5521946    -1.78   0.075     -2.06382    .1007427
              1 2014  |  -1.173615   .5585289    -2.10   0.036    -2.268312   -.0789188
              1 2015  |  -.8858376   .5566255    -1.59   0.112    -1.976803    .2051282
              1 2016  |  -1.017192   .5632461    -1.81   0.071    -2.121134      .08675
              1 2017  |  -.9542947   .5580931    -1.71   0.087    -2.048137    .1395477
              1 2018  |  -1.205993   .5602642    -2.15   0.031     -2.30409   -.1078953
              1 2019  |  -1.374534   .5458763    -2.52   0.012    -2.444432   -.3046365
              1 2020  |  -1.564457   .5492602    -2.85   0.004    -2.640987   -.4879269
              1 2021  |  -1.329123   .5577587    -2.38   0.017     -2.42231   -.2359361
              1 2022  |  -1.190496   .5480502    -2.17   0.030    -2.264654    -.116337
                      |
                _cons |  -.4054642   .5270488    -0.77   0.442    -1.438461    .6275324
---------------------------------------------------------------------------------------

. 
. 
. keep if syear < 2007
(86,427 observations deleted)

. logit if_savings type_employment##i.syear, robust

Iteration 0:   log pseudolikelihood = -12424.521  
Iteration 1:   log pseudolikelihood = -12398.045  
Iteration 2:   log pseudolikelihood = -12397.918  
Iteration 3:   log pseudolikelihood = -12397.918  

Logistic regression                             Number of obs     =     19,569
                                                Wald chi2(29)     =      53.62
                                                Prob > chi2       =     0.0036
Log pseudolikelihood = -12397.918               Pseudo R2         =     0.0021

---------------------------------------------------------------------------------------
                      |               Robust
           if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
    1.type_employment |   1.094846   .5376662     2.04   0.042     .0410393    2.148652
                      |
                syear |
                1993  |   .4054649   .7817559     0.52   0.604    -1.126749    1.937678
                1994  |   1.504077   .9718501     1.55   0.122     -.400714    3.408868
                1995  |   .9650807   .8189439     1.18   0.239    -.6400199    2.570181
                1996  |   .1177829   .9279844     0.13   0.899    -1.701033    1.936599
                1997  |   .2231434   .8027935     0.28   0.781    -1.350303     1.79659
                1998  |   .4054649   .6912324     0.59   0.557    -.9493256    1.760255
                1999  |   .6286085   .7090864     0.89   0.375    -.7611752    2.018392
                2000  |   .4284545   .5690144     0.75   0.451    -.6867933    1.543702
                2001  |   .7472142   .5840788     1.28   0.201    -.3975591    1.891988
                2002  |   .5389963   .5756441     0.94   0.349    -.5892454    1.667238
                2003  |   .9650807   .5858938     1.65   0.100    -.1832499    2.113411
                2004  |   .5645296   .5845423     0.97   0.334    -.5811523    1.710212
                2005  |   .9253404   .5918422     1.56   0.118    -.2346491     2.08533
                2006  |   .7326778   .5773289     1.27   0.204     -.398866    1.864222
                      |
type_employment#syear |
              1 1993  |  -.2565164   .7952253    -0.32   0.747    -1.815129    1.302096
              1 1994  |  -1.312674   .9818399    -1.34   0.181    -3.237045     .611697
              1 1995  |  -.9781923   .8296229    -1.18   0.238    -2.604223    .6478388
              1 1996  |  -.0550603   .9372328    -0.06   0.953    -1.892003    1.781882
              1 1997  |  -.1419305   .8131722    -0.17   0.861    -1.735719    1.451858
              1 1998  |  -.4138567   .7025992    -0.59   0.556    -1.790926    .9632124
              1 1999  |  -.5777241   .7200106    -0.80   0.422    -1.988919    .8334708
              1 2000  |  -.3979752   .5810217    -0.68   0.493    -1.536757    .7408065
              1 2001  |  -.6295891    .595923    -1.06   0.291    -1.797577    .5383985
              1 2002  |  -.5343927   .5875126    -0.91   0.363    -1.685896    .6171109
              1 2003  |  -.9862652   .5974692    -1.65   0.099    -2.157283    .1847528
              1 2004  |  -.5679316   .5961287    -0.95   0.341    -1.736323    .6004592
              1 2005  |  -.8783112   .6032809    -1.46   0.145     -2.06072    .3040977
              1 2006  |  -.7698751   .5887877    -1.31   0.191    -1.923878    .3841277
                      |
                _cons |  -.4054649   .5270597    -0.77   0.442    -1.438483    .6275531
---------------------------------------------------------------------------------------

. testparm type_employment#i.syear

 ( 1)  [if_savings]1.type_employment#1993.syear = 0
 ( 2)  [if_savings]1.type_employment#1994.syear = 0
 ( 3)  [if_savings]1.type_employment#1995.syear = 0
 ( 4)  [if_savings]1.type_employment#1996.syear = 0
 ( 5)  [if_savings]1.type_employment#1997.syear = 0
 ( 6)  [if_savings]1.type_employment#1998.syear = 0
 ( 7)  [if_savings]1.type_employment#1999.syear = 0
 ( 8)  [if_savings]1.type_employment#2000.syear = 0
 ( 9)  [if_savings]1.type_employment#2001.syear = 0
 (10)  [if_savings]1.type_employment#2002.syear = 0
 (11)  [if_savings]1.type_employment#2003.syear = 0
 (12)  [if_savings]1.type_employment#2004.syear = 0
 (13)  [if_savings]1.type_employment#2005.syear = 0
 (14)  [if_savings]1.type_employment#2006.syear = 0

           chi2( 14) =    8.56
         Prob > chi2 =    0.8579

. 
. 
. *** savings_amount ***
. drop if savings_amount <=0
(6,478 observations deleted)

. drop if missing(savings_amount)
(643 observations deleted)

. 
. * Generate log savings
. gen log = log(savings_amount)

. 
. xtset hid syear
       panel variable:  hid (unbalanced)
        time variable:  syear, 1992 to 2006, but with gaps
                delta:  1 unit

. reg log type_employment##i.syear, robust

Linear regression                               Number of obs     =     12,645
                                                F(29, 12615)      =       3.55
                                                Prob > F          =     0.0000
                                                R-squared         =     0.0082
                                                Root MSE          =      .8805

---------------------------------------------------------------------------------------
                      |               Robust
                  log |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
    1.type_employment |  -.6628974   .3766524    -1.76   0.078    -1.401193    .0753986
                      |
                syear |
                1993  |  -.2070942   .4843952    -0.43   0.669    -1.156582     .742394
                1994  |  -.8474152   .6836004    -1.24   0.215    -2.187376    .4925454
                1995  |  -.4525048    .528342    -0.86   0.392    -1.488136    .5831259
                1996  |  -.2279116   .9559148    -0.24   0.812     -2.10165    1.645827
                1997  |  -.4409421    .722009    -0.61   0.541     -1.85619    .9743054
                1998  |  -.7332957   .4735875    -1.55   0.122    -1.661599    .1950079
                1999  |  -.6157311   .4399096    -1.40   0.162    -1.478021    .2465585
                2000  |  -.5917424   .4086379    -1.45   0.148    -1.392735      .20925
                2001  |  -.7078396   .3972366    -1.78   0.075    -1.486484    .0708047
                2002  |  -.4100031   .4013202    -1.02   0.307    -1.196652    .3766455
                2003  |  -.4140223   .4004974    -1.03   0.301    -1.199058    .3710135
                2004  |  -.4825955   .3949819    -1.22   0.222     -1.25682     .291629
                2005  |  -.5495305   .4130078    -1.33   0.183    -1.359089    .2600276
                2006  |  -.2104565   .4131931    -0.51   0.611    -1.020378    .5994648
                      |
type_employment#syear |
              1 1993  |   .1329142   .4892061     0.27   0.786    -.8260041    1.091832
              1 1994  |   .8076198   .6867231     1.18   0.240    -.5384619    2.153701
              1 1995  |   .3943505   .5320964     0.74   0.459    -.6486393     1.43734
              1 1996  |   .1124727   .9580338     0.12   0.907    -1.765419    1.990365
              1 1997  |   .3652018   .7246702     0.50   0.614    -1.055262    1.785665
              1 1998  |   .5821854   .4774861     1.22   0.223      -.35376    1.518131
              1 1999  |   .4067407   .4439672     0.92   0.360    -.4635026    1.276984
              1 2000  |   .3759759   .4124856     0.91   0.362    -.4325585     1.18451
              1 2001  |   .4938966   .4012237     1.23   0.218     -.292563    1.280356
              1 2002  |   .2572345   .4053228     0.63   0.526    -.5372599    1.051729
              1 2003  |   .2239305   .4044592     0.55   0.580    -.5688711    1.016732
              1 2004  |   .2715344   .3989899     0.68   0.496    -.5105465    1.053615
              1 2005  |   .4166021   .4168346     1.00   0.318    -.4004572    1.233661
              1 2006  |   .0635892   .4169528     0.15   0.879    -.7537017    .8808802
                      |
                _cons |   6.500851   .3732875    17.42   0.000     5.769151    7.232551
---------------------------------------------------------------------------------------

. testparm type_employment#i.syear

 ( 1)  1.type_employment#1993.syear = 0
 ( 2)  1.type_employment#1994.syear = 0
 ( 3)  1.type_employment#1995.syear = 0
 ( 4)  1.type_employment#1996.syear = 0
 ( 5)  1.type_employment#1997.syear = 0
 ( 6)  1.type_employment#1998.syear = 0
 ( 7)  1.type_employment#1999.syear = 0
 ( 8)  1.type_employment#2000.syear = 0
 ( 9)  1.type_employment#2001.syear = 0
 (10)  1.type_employment#2002.syear = 0
 (11)  1.type_employment#2003.syear = 0
 (12)  1.type_employment#2004.syear = 0
 (13)  1.type_employment#2005.syear = 0
 (14)  1.type_employment#2006.syear = 0

       F( 14, 12615) =    0.54
            Prob > F =    0.9087

. 
. 
. *** saving rate ***
. drop if household_income == 0
(0 observations deleted)

. drop if household_income == .
(224 observations deleted)

. 
. gen rate = savings_amount/household_income

. xtset hid syear
       panel variable:  hid (unbalanced)
        time variable:  syear, 1992 to 2006, but with gaps
                delta:  1 unit

. reg rate type_employment##i.syear, robust

Linear regression                               Number of obs     =     12,421
                                                F(29, 12391)      =       7.09
                                                Prob > F          =     0.0000
                                                R-squared         =     0.0187
                                                Root MSE          =     .11066

---------------------------------------------------------------------------------------
                      |               Robust
                 rate |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
    1.type_employment |  -.0869503   .0492901    -1.76   0.078    -.1835665    .0096659
                      |
                syear |
                1993  |  -.0421915   .0642204    -0.66   0.511    -.1680734    .0836904
                1994  |  -.1230088   .0609741    -2.02   0.044    -.2425276     -.00349
                1995  |   -.068823   .0802976    -0.86   0.391    -.2262189    .0885728
                1996  |  -.0179917   .1429014    -0.13   0.900    -.2981007    .2621173
                1997  |  -.0553704   .0915467    -0.60   0.545    -.2348161    .1240753
                1998  |  -.1409044   .0585535    -2.41   0.016    -.2556785   -.0261304
                1999  |  -.1300468   .0555874    -2.34   0.019    -.2390066   -.0210869
                2000  |  -.0889425   .0540551    -1.65   0.100    -.1948988    .0170139
                2001  |  -.1233931   .0518608    -2.38   0.017    -.2250482   -.0217379
                2002  |  -.1155847   .0524849    -2.20   0.028    -.2184633   -.0127061
                2003  |   -.106984   .0531051    -2.01   0.044    -.2110783   -.0028897
                2004  |  -.1487363   .0502116    -2.96   0.003    -.2471588   -.0503138
                2005  |  -.1214085   .0548186    -2.21   0.027    -.2288615   -.0139555
                2006  |  -.0894039   .0540067    -1.66   0.098    -.1952654    .0164576
                      |
type_employment#syear |
              1 1993  |   .0285899   .0651564     0.44   0.661    -.0991268    .1563066
              1 1994  |   .1112851   .0618437     1.80   0.072    -.0099383    .2325084
              1 1995  |   .0501373   .0809136     0.62   0.536     -.108466    .2087406
              1 1996  |  -.0041721   .1432314    -0.03   0.977    -.2849279    .2765837
              1 1997  |   .0343298   .0920495     0.37   0.709    -.1461015     .214761
              1 1998  |   .1094969   .0592937     1.85   0.065     -.006728    .2257218
              1 1999  |   .0878503   .0563362     1.56   0.119    -.0225775    .1982781
              1 2000  |   .0422146   .0547551     0.77   0.441     -.065114    .1495431
              1 2001  |   .0763556   .0525922     1.45   0.147    -.0267333    .1794444
              1 2002  |   .0641769    .053196     1.21   0.228    -.0400956    .1684493
              1 2003  |   .0550162   .0538123     1.02   0.307    -.0504642    .1604966
              1 2004  |   .0903412   .0509506     1.77   0.076      -.00953    .1902123
              1 2005  |   .0749485   .0555215     1.35   0.177    -.0338822    .1837792
              1 2006  |    .039986   .0547035     0.73   0.465    -.0672414    .1472134
                      |
                _cons |    .271362   .0486101     5.58   0.000     .1760785    .3666454
---------------------------------------------------------------------------------------

. testparm type_employment#i.syear

 ( 1)  1.type_employment#1993.syear = 0
 ( 2)  1.type_employment#1994.syear = 0
 ( 3)  1.type_employment#1995.syear = 0
 ( 4)  1.type_employment#1996.syear = 0
 ( 5)  1.type_employment#1997.syear = 0
 ( 6)  1.type_employment#1998.syear = 0
 ( 7)  1.type_employment#1999.syear = 0
 ( 8)  1.type_employment#2000.syear = 0
 ( 9)  1.type_employment#2001.syear = 0
 (10)  1.type_employment#2002.syear = 0
 (11)  1.type_employment#2003.syear = 0
 (12)  1.type_employment#2004.syear = 0
 (13)  1.type_employment#2005.syear = 0
 (14)  1.type_employment#2006.syear = 0

       F( 14, 12391) =    0.91
            Prob > F =    0.5422

. 
. 
. 
. ***********************************************
. * Event Study
. ***********************************************
. use "${DATA}data_head.dta", clear

. 
. * Generate Post and Interaction
. gen post = syear > 2006

. gen interaction = post * type_employment

. gen treated = (type_employment == 1)

. 
. * Event Study Setup
. gen rel_year = syear - 2007

. keep if rel_year >= -6 & rel_year <= 6 // restrict years to avoid sparse tails
(67,168 observations deleted)

. tab rel_year, gen(Dyear)

   rel_year |      Freq.     Percent        Cum.
------------+-----------------------------------
         -6 |      1,828        4.68        4.68
         -5 |      1,901        4.87        9.56
         -4 |      1,938        4.97       14.52
         -3 |      1,972        5.05       19.57
         -2 |      2,001        5.13       24.70
         -1 |      2,229        5.71       30.41
          0 |      2,251        5.77       36.18
          1 |      2,229        5.71       41.89
          2 |      2,484        6.37       48.26
          3 |      4,385       11.24       59.50
          4 |      4,899       12.55       72.05
          5 |      4,961       12.71       84.76
          6 |      5,947       15.24      100.00
------------+-----------------------------------
      Total |     39,025      100.00

. foreach i in  1 2 3 4 5 6 {
  2.     local dy = -`i' + 7
  3.     gen did_`i' = Dyear`dy' * treated
  4. }

. 
. foreach i in  1 2 3 4 5 6 {
  2.     local dy = `i' + 7
  3.     gen did`i' = Dyear`dy' * treated
  4. }

. *** if savings
. xtset hid syear
       panel variable:  hid (unbalanced)
        time variable:  syear, 2001 to 2013, but with gaps
                delta:  1 unit

. xtlogit if_savings ///
>         did_6 did_5 did_4 did_3 did_2 did_1 did1 did2 did3 did4 did5 ///
>         hh_size nchild full_time years_employ education_years vocational_degree, fe
note: multiple positive outcomes within groups encountered.
note: 6,825 groups (19,697 obs) dropped because of all positive or
      all negative outcomes.

Iteration 0:   log likelihood = -6726.7866  
Iteration 1:   log likelihood = -6695.4535  
Iteration 2:   log likelihood = -6695.4073  
Iteration 3:   log likelihood = -6695.4073  

Conditional fixed-effects logistic regression   Number of obs     =     17,596
Group variable: hid                             Number of groups  =      3,012

                                                Obs per group:
                                                              min =          2
                                                              avg =        5.8
                                                              max =         13

                                                LR chi2(17)       =     210.55
Log likelihood  = -6695.4073                    Prob > chi2       =     0.0000

-----------------------------------------------------------------------------------
       if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
            did_6 |   .5839151   .1431316     4.08   0.000     .3033824    .8644478
            did_5 |   .1598823   .1319375     1.21   0.226    -.0987105    .4184751
            did_4 |    .076922    .121545     0.63   0.527    -.1613018    .3151458
            did_3 |   .0278843   .1131956     0.25   0.805    -.1939751    .2497436
            did_2 |   .0309755    .103804     0.30   0.765    -.1724765    .2344276
            did_1 |  -.3297856   .0929203    -3.55   0.000    -.5119061   -.1476652
             did1 |  -.0890905   .0842069    -1.06   0.290     -.254133     .075952
             did2 |  -.2182832   .0803648    -2.72   0.007    -.3757952   -.0607711
             did3 |  -.2074254   .0662093    -3.13   0.002    -.3371932   -.0776577
             did4 |  -.0251068   .0622958    -0.40   0.687    -.1472042    .0969907
             did5 |  -.1042285   .0618993    -1.68   0.092    -.2255489     .017092
          hh_size |   .2645355   .0498389     5.31   0.000      .166853     .362218
           nchild |  -.2154717   .0552777    -3.90   0.000     -.323814   -.1071294
        full_time |   .4657849   .0836023     5.57   0.000     .3019275    .6296424
     years_employ |   .0521916   .0125399     4.16   0.000     .0276138    .0767694
  education_years |   .2034274   .0551222     3.69   0.000     .0953899    .3114648
vocational_degree |   .8019488   .2550012     3.14   0.002     .3021557    1.301742
-----------------------------------------------------------------------------------

. 
. 
. 
. 
. 
. * Plot coefficients (omit 0 as baseline)
. coefplot, keep(did*) vertical xline(6) ///
>     title("Event Study: if savings") ///
>     ytitle("Effect relative to 2007") xtitle("Year relative to reform")

. 
. 
.         
. *** savings_amount
. * drop obs with data quality issue
. drop if if_savings == .
(323 observations deleted)

. drop if savings_amount == .
(877 observations deleted)

. 
. * Filter people who always save
. gen has_zero = (if_savings == 0)

. bysort hid (syear): egen any_zero = max(has_zero)

. drop if any_zero == 1
(23,397 observations deleted)

. 
. * Generate log savings
. gen log = log(savings_amount)

. 
. xtset hid syear
       panel variable:  hid (unbalanced)
        time variable:  syear, 2001 to 2013, but with gaps
                delta:  1 unit

. * Regress with fixed effects and covariates if needed
. xtreg log ///
>      did_6 did_5 did_4 did_3 did_2 did_1 did1 did2 did3 did4 did5 ///
>          did6 female age age_square i.migback ///
>         hh_size nchild full_time years_employ education_years vocational_degree, ///
>          vce(cluster hid)

Random-effects GLS regression                   Number of obs     =     13,794
Group variable: hid                             Number of groups  =      4,137

R-sq:                                           Obs per group:
     within  = 0.0441                                         min =          1
     between = 0.1892                                         avg =        3.3
     overall = 0.1740                                         max =         13

                                                Wald chi2(23)     =     832.91
corr(u_i, X)   = 0 (assumed)                    Prob > chi2       =     0.0000

                                     (Std. Err. adjusted for 4,137 clusters in hid)
-----------------------------------------------------------------------------------
                  |               Robust
              log |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
            did_6 |  -.0352129   .0360864    -0.98   0.329    -.1059409    .0355151
            did_5 |  -.0562499   .0371592    -1.51   0.130    -.1290806    .0165807
            did_4 |  -.0335192    .033319    -1.01   0.314    -.0988232    .0317848
            did_3 |  -.0522329   .0318723    -1.64   0.101    -.1147014    .0102356
            did_2 |   .0429234   .0296998     1.45   0.148    -.0152872     .101134
            did_1 |  -.0263829   .0256105    -1.03   0.303    -.0765787    .0238128
             did1 |  -.0502561   .0246552    -2.04   0.042    -.0985795   -.0019328
             did2 |  -.0729393   .0283467    -2.57   0.010    -.1284977   -.0173808
             did3 |  -.0833258    .026915    -3.10   0.002    -.1360784   -.0305733
             did4 |  -.0064602   .0281158    -0.23   0.818    -.0615661    .0486456
             did5 |    .014341   .0289256     0.50   0.620    -.0423522    .0710341
             did6 |   .0104628   .0300336     0.35   0.728    -.0484021    .0693276
           female |  -.1085366   .0329016    -3.30   0.001    -.1730226   -.0440507
              age |   .0569502   .0172308     3.31   0.001     .0231785     .090722
       age_square |  -.0007251   .0002437    -2.98   0.003    -.0012028   -.0002474
                  |
          migback |
               2  |   .0102407   .0419191     0.24   0.807    -.0719193    .0924007
               3  |   .0142643   .0487035     0.29   0.770    -.0811928    .1097213
                  |
          hh_size |   .2712455   .0244506    11.09   0.000     .2233232    .3191678
           nchild |  -.3066275   .0318841    -9.62   0.000    -.3691191   -.2441358
        full_time |   .1612311   .0323875     4.98   0.000     .0977528    .2247093
     years_employ |   .0117469    .004739     2.48   0.013     .0024586    .0210351
  education_years |   .1117116   .0068541    16.30   0.000     .0982779    .1251454
vocational_degree |  -.0794191   .0358237    -2.22   0.027    -.1496323    -.009206
            _cons |   2.651387     .30275     8.76   0.000     2.058008    3.244766
------------------+----------------------------------------------------------------
          sigma_u |  .73108768
          sigma_e |  .54561685
              rho |  .64227059   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. 
. * Plot coefficients (omit 0 as baseline)
. coefplot, keep(did*) vertical xline(6.5) ///
>     title("Event Study: savings amount") ///
>     ytitle("Effect relative to 2007") xtitle("Year relative to reform")

. 
. 
. ***********************************************
. * Placebo Test
. ***********************************************
. ***********************************************
. * Extensive Margin: If Savings
. ***********************************************
. use "${OUT_DATA}data_head.dta", clear

. 
. * Generate Post-Reform Indicator
. gen post = syear > 2000

. 
. * Generate Interaction Term for DiD
. gen interaction = post * type_employment

. 
.         
.         
. *** Logit Model
. logit if_savings interaction post type_employment, robust

Iteration 0:   log pseudolikelihood = -62770.773  
Iteration 1:   log pseudolikelihood = -62749.334  
Iteration 2:   log pseudolikelihood = -62749.174  
Iteration 3:   log pseudolikelihood = -62749.174  

Logistic regression                             Number of obs     =    101,601
                                                Wald chi2(3)      =      43.91
                                                Prob > chi2       =     0.0000
Log pseudolikelihood = -62749.174               Pseudo R2         =     0.0003

---------------------------------------------------------------------------------
                |               Robust
     if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
    interaction |  -.7816285   .1511361    -5.17   0.000     -1.07785   -.4854072
           post |   .8516367   .1489644     5.72   0.000     .5596719    1.143601
type_employment |   .6871594   .1475738     4.66   0.000     .3979201    .9763988
          _cons |   .0529224   .1455302     0.36   0.716    -.2323116    .3381564
---------------------------------------------------------------------------------

. estimates store logit1

. margins, dydx(interaction)

Average marginal effects                        Number of obs     =    101,601
Model VCE    : Robust

Expression   : Pr(if_savings), predict()
dy/dx w.r.t. : interaction

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 interaction |  -.1666396   .0322058    -5.17   0.000    -.2297617   -.1035175
------------------------------------------------------------------------------

. 
. logit if_savings interaction post type_employment female age age_square i.migback ///
>         hh_size nchild, robust

Iteration 0:   log pseudolikelihood = -62369.907  
Iteration 1:   log pseudolikelihood = -60643.779  
Iteration 2:   log pseudolikelihood = -60631.598  
Iteration 3:   log pseudolikelihood = -60631.597  

Logistic regression                             Number of obs     =    101,031
                                                Wald chi2(10)     =    3325.39
                                                Prob > chi2       =     0.0000
Log pseudolikelihood = -60631.597               Pseudo R2         =     0.0279

---------------------------------------------------------------------------------
                |               Robust
     if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
    interaction |  -.6290374   .1641854    -3.83   0.000    -.9508348     -.30724
           post |   .7515489   .1623845     4.63   0.000     .4332812    1.069817
type_employment |   .6507709   .1606509     4.05   0.000     .3359009    .9656409
         female |  -.1046509   .0141409    -7.40   0.000    -.1323666   -.0769353
            age |   .0007535   .0076723     0.10   0.922    -.0142839    .0157908
     age_square |   .0001145   .0000985     1.16   0.245    -.0000787    .0003076
                |
        migback |
             2  |  -.7525203   .0165221   -45.55   0.000    -.7849029   -.7201376
             3  |  -.3245575   .0271576   -11.95   0.000    -.3777853   -.2713297
                |
        hh_size |   .1534572   .0124086    12.37   0.000     .1291368    .1777775
         nchild |  -.3562863   .0148296   -24.03   0.000    -.3853518   -.3272208
          _cons |   .0258506   .2124026     0.12   0.903    -.3904509    .4421521
---------------------------------------------------------------------------------

. estimates store logit2

. 
. logit if_savings interaction post type_employment female age age_square i.migback ///
>         hh_size nchild full_time years_employ education_years vocational_degree, robust

Iteration 0:   log pseudolikelihood = -58782.807  
Iteration 1:   log pseudolikelihood = -54296.208  
Iteration 2:   log pseudolikelihood = -54187.633  
Iteration 3:   log pseudolikelihood = -54187.238  
Iteration 4:   log pseudolikelihood = -54187.238  

Logistic regression                             Number of obs     =     95,529
                                                Wald chi2(14)     =    7524.59
                                                Prob > chi2       =     0.0000
Log pseudolikelihood = -54187.238               Pseudo R2         =     0.0782

-----------------------------------------------------------------------------------
                  |               Robust
       if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      interaction |  -.5755145   .1934791    -2.97   0.003    -.9547266   -.1963023
             post |   .5814207   .1917631     3.03   0.002      .205572    .9572694
  type_employment |   .8073817   .1899196     4.25   0.000     .4351461    1.179617
           female |   .0291878   .0174856     1.67   0.095    -.0050834     .063459
              age |  -.0703355   .0082781    -8.50   0.000    -.0865602   -.0541108
       age_square |   .0005844   .0001053     5.55   0.000      .000378    .0007907
                  |
          migback |
               2  |  -.2505917   .0198333   -12.63   0.000    -.2894643    -.211719
               3  |  -.2146667   .0291159    -7.37   0.000    -.2717327   -.1576006
                  |
          hh_size |   .1863773   .0128333    14.52   0.000     .1612245      .21153
           nchild |   -.342912   .0153824   -22.29   0.000    -.3730609    -.312763
        full_time |   .2775621   .0208089    13.34   0.000     .2367775    .3183467
     years_employ |   .0386106   .0017696    21.82   0.000     .0351422    .0420789
  education_years |   .2416127   .0035563    67.94   0.000     .2346425     .248583
vocational_degree |   .1098136   .0175856     6.24   0.000     .0753465    .1442806
            _cons |  -2.142779   .2450285    -8.75   0.000    -2.623026   -1.662532
-----------------------------------------------------------------------------------

. estimates store logit3

. 
. logit if_savings interaction type_employment female age age_square i.migback ///
>         hh_size nchild full_time years_employ education_years vocational_degree i.syear, robust

Iteration 0:   log pseudolikelihood = -58782.807  
Iteration 1:   log pseudolikelihood = -53766.459  
Iteration 2:   log pseudolikelihood = -53637.948  
Iteration 3:   log pseudolikelihood = -53637.819  
Iteration 4:   log pseudolikelihood = -53637.819  

Logistic regression                             Number of obs     =     95,529
                                                Wald chi2(43)     =    8404.63
                                                Prob > chi2       =     0.0000
Log pseudolikelihood = -53637.819               Pseudo R2         =     0.0875

-----------------------------------------------------------------------------------
                  |               Robust
       if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      interaction |  -.5437707   .1938412    -2.81   0.005    -.9236925   -.1638489
  type_employment |   .7925783    .190193     4.17   0.000     .4198069     1.16535
           female |   .0260909   .0176663     1.48   0.140    -.0085344    .0607161
              age |  -.0059413   .0086416    -0.69   0.492    -.0228786     .010996
       age_square |  -.0004523   .0001117    -4.05   0.000    -.0006712   -.0002334
                  |
          migback |
               2  |  -.3658574   .0204039   -17.93   0.000    -.4058483   -.3258666
               3  |  -.2516478   .0294206    -8.55   0.000    -.3093112   -.1939845
                  |
          hh_size |   .1924873   .0130182    14.79   0.000     .1669722    .2180025
           nchild |  -.3316365   .0155819   -21.28   0.000    -.3621765   -.3010966
        full_time |   .2923031   .0210689    13.87   0.000     .2510089    .3335973
     years_employ |   .0441385   .0018178    24.28   0.000     .0405756    .0477013
  education_years |   .2421568   .0035615    67.99   0.000     .2351763    .2491373
vocational_degree |   .1743443   .0178524     9.77   0.000     .1393542    .2093345
                  |
            syear |
            1993  |   .1445663    .186941     0.77   0.439    -.2218314    .5109639
            1994  |   .2331198   .1813552     1.29   0.199    -.1223298    .5885693
            1995  |  -.0608223   .1606482    -0.38   0.705     -.375687    .2540424
            1996  |  -.0311476   .1599432    -0.19   0.846    -.3446305    .2823353
            1997  |  -.0259713   .1587686    -0.16   0.870    -.3371521    .2852095
            1998  |   -.164534   .1553694    -1.06   0.290    -.4690525    .1399844
            1999  |   -.039308   .1542685    -0.25   0.799    -.3416687    .2630528
            2000  |  -.1804484   .1473848    -1.22   0.221    -.4693172    .1084205
            2001  |   .4117834   .2388239     1.72   0.085    -.0563028    .8798696
            2002  |   .2480612   .2384625     1.04   0.298    -.2193166    .7154391
            2003  |   .2642968   .2382579     1.11   0.267    -.2026801    .7312738
            2004  |   .2564316   .2383446     1.08   0.282    -.2107151    .7235784
            2005  |   .3184049   .2383007     1.34   0.182     -.148656    .7854658
            2006  |   .2058587   .2379147     0.87   0.387    -.2604455    .6721629
            2007  |   .3610948   .2380467     1.52   0.129    -.1054682    .8276578
            2008  |   .3712843   .2382322     1.56   0.119    -.0956422    .8382108
            2009  |   .2903094   .2378128     1.22   0.222    -.1757951    .7564139
            2010  |   .1498436   .2358834     0.64   0.525    -.3124794    .6121666
            2011  |     .28702   .2355108     1.22   0.223    -.1745727    .7486128
            2012  |   .2499868   .2354717     1.06   0.288    -.2115293    .7115029
            2013  |   .3712865   .2351659     1.58   0.114    -.0896301    .8322031
            2014  |   .4327663   .2355881     1.84   0.066    -.0289778    .8945105
            2015  |   .4821479   .2354531     2.05   0.041     .0206683    .9436276
            2016  |   .5788687   .2358329     2.45   0.014     .1166446    1.041093
            2017  |   .6641957   .2355661     2.82   0.005     .2024945    1.125897
            2018  |   .7350473    .235655     3.12   0.002      .273172    1.196923
            2019  |   .9033508   .2352711     3.84   0.000     .4422279    1.364474
            2020  |   .8152458   .2351374     3.47   0.001     .3543849    1.276107
            2021  |   1.178191   .2363091     4.99   0.000     .7150337    1.641348
            2022  |   .9734017   .2350019     4.14   0.000     .5128063    1.433997
                  |
            _cons |   -3.14369   .2763974   -11.37   0.000    -3.685419   -2.601961
-----------------------------------------------------------------------------------

. estimates store logit4

. 
. *** add household fe
. xtset hid syear
       panel variable:  hid (unbalanced)
        time variable:  syear, 1992 to 2022, but with gaps
                delta:  1 unit

. xtlogit if_savings interaction post age age_square ///
>         hh_size nchild full_time years_employ education_years vocational_degree, fe
note: multiple positive outcomes within groups encountered.
note: 15,366 groups (44,567 obs) dropped because of all positive or
      all negative outcomes.

Iteration 0:   log likelihood = -19634.554  
Iteration 1:   log likelihood = -19466.842  
Iteration 2:   log likelihood = -19466.537  
Iteration 3:   log likelihood = -19466.537  

Conditional fixed-effects logistic regression   Number of obs     =     50,962
Group variable: hid                             Number of groups  =      6,442

                                                Obs per group:
                                                              min =          2
                                                              avg =        7.9
                                                              max =         31

                                                LR chi2(10)       =     909.31
Log likelihood  = -19466.537                    Prob > chi2       =     0.0000

-----------------------------------------------------------------------------------
       if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      interaction |   .2712153   .2405187     1.13   0.259    -.2001927    .7426233
             post |  -.8160855   .2410212    -3.39   0.001    -1.288478   -.3436925
              age |  -.0972461   .0219935    -4.42   0.000    -.1403526   -.0541396
       age_square |   .0016396   .0002561     6.40   0.000     .0011376    .0021416
          hh_size |   .2320105    .025987     8.93   0.000     .1810769     .282944
           nchild |  -.2388787   .0279528    -8.55   0.000    -.2936652   -.1840921
        full_time |   .3612891   .0436895     8.27   0.000     .2756592     .446919
     years_employ |   .0355079   .0104316     3.40   0.001     .0150622    .0559535
  education_years |   .1673042   .0276003     6.06   0.000     .1132086    .2213999
vocational_degree |   .2452968   .1005016     2.44   0.015     .0483173    .4422762
-----------------------------------------------------------------------------------

. estimates store logit5

. 
. *** add household and year fe
. xtset hid syear
       panel variable:  hid (unbalanced)
        time variable:  syear, 1992 to 2022, but with gaps
                delta:  1 unit

. xtlogit if_savings interaction age age_square ///
>         hh_size nchild full_time years_employ education_years vocational_degree i.syear, fe
note: multiple positive outcomes within groups encountered.
note: 15,366 groups (44,567 obs) dropped because of all positive or
      all negative outcomes.

Iteration 0:   log likelihood = -19363.238  
Iteration 1:   log likelihood = -19236.723  
Iteration 2:   log likelihood =  -19236.49  
Iteration 3:   log likelihood =  -19236.49  

Conditional fixed-effects logistic regression   Number of obs     =     50,962
Group variable: hid                             Number of groups  =      6,442

                                                Obs per group:
                                                              min =          2
                                                              avg =        7.9
                                                              max =         31

                                                LR chi2(39)       =    1369.40
Log likelihood  =  -19236.49                    Prob > chi2       =     0.0000

-----------------------------------------------------------------------------------
       if_savings |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
      interaction |   .2048292    .242583     0.84   0.398    -.2706248    .6802832
              age |  -.0490916   .0270121    -1.82   0.069    -.1020344    .0038511
       age_square |  -.0002543   .0002829    -0.90   0.369    -.0008088    .0003001
          hh_size |   .2231851   .0262137     8.51   0.000     .1718073    .2745629
           nchild |  -.2345719   .0283284    -8.28   0.000    -.2900946   -.1790492
        full_time |   .3644444   .0445109     8.19   0.000     .2772046    .4516842
     years_employ |    .039071    .010778     3.63   0.000     .0179466    .0601955
  education_years |   .1399222   .0281282     4.97   0.000      .084792    .1950524
vocational_degree |   .3079475   .1027834     3.00   0.003     .1064958    .5093992
                  |
            syear |
            1993  |   .0114953   .2563434     0.04   0.964    -.4909285     .513919
            1994  |   .0510272    .251644     0.20   0.839     -.442186    .5442404
            1995  |  -.1333012   .2326981    -0.57   0.567     -.589381    .3227787
            1996  |  -.1248625   .2349217    -0.53   0.595    -.5853007    .3355756
            1997  |  -.0793224   .2377772    -0.33   0.739    -.5453573    .3867124
            1998  |  -.2707315   .2405466    -1.13   0.260    -.7421942    .2007311
            1999  |   -.060993   .2455832    -0.25   0.804    -.5423271    .4203412
            2000  |  -.1297267    .246624    -0.53   0.599    -.6131009    .3536475
            2001  |  -.1590007   .3507694    -0.45   0.650    -.8464961    .5284948
            2002  |  -.4428541   .3566792    -1.24   0.214    -1.141933    .2562243
            2003  |  -.4373478   .3633742    -1.20   0.229    -1.149548    .2748525
            2004  |  -.4155831   .3701779    -1.12   0.262    -1.141118    .3099523
            2005  |  -.3338225   .3779776    -0.88   0.377    -1.074645        .407
            2006  |  -.5855782   .3850724    -1.52   0.128    -1.340306    .1691498
            2007  |  -.2944462    .393442    -0.75   0.454    -1.065578     .476686
            2008  |  -.2082825   .4020442    -0.52   0.604    -.9962746    .5797096
            2009  |  -.2458356   .4104361    -0.60   0.549    -1.050276    .5586044
            2010  |   -.250221   .4181682    -0.60   0.550    -1.069816    .5693736
            2011  |   -.022647   .4269367    -0.05   0.958    -.8594276    .8141337
            2012  |  -.0203519   .4362034    -0.05   0.963    -.8752948     .834591
            2013  |   .2089349   .4452312     0.47   0.639    -.6637022    1.081572
            2014  |   .3078568   .4552331     0.68   0.499    -.5843837    1.200097
            2015  |   .4520582   .4648659     0.97   0.331    -.4590623    1.363179
            2016  |   .6225047    .475516     1.31   0.190    -.3094896    1.554499
            2017  |    .714779   .4859298     1.47   0.141    -.2376259    1.667184
            2018  |   .9112197   .4965852     1.83   0.067    -.0620694    1.884509
            2019  |    1.20211    .507462     2.37   0.018      .207503    2.196718
            2020  |   1.228653   .5187339     2.37   0.018     .2119531    2.245353
            2021  |   1.889617   .5297218     3.57   0.000     .8513812    2.927853
            2022  |   1.361479   .5414453     2.51   0.012      .300266    2.422693
-----------------------------------------------------------------------------------

. estimates store logit6 drop(*.syear)
( invalid name
* invalid name
.syear invalid name
) invalid name
r(7);

end of do-file

r(7);

. do "/Users/angelxu/Desktop/thesis/data/SOEP/reform analysis/do/4_did_inten_head.do"

. clear all

. set more off

. cap log close
